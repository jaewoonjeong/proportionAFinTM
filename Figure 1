rm(list=ls())
Norway=read.csv("Norway.csv"); Norway=subset(Norway,Year!=2021)
Norway$Prop_AF=(Norway$AF)/Norway$Tot_Mob
BC=read.csv("BC.csv")
BC$Prop_AF=(BC$Leps_AF)/BC$Leps_mot; BC=BC[-which(BC$Leps_mot<BC$Leps_AF),]

set.seed(1)
hd=Norway[sample(1:dim(Norway)[1],dim(BC)[1]),]; 

llm=lm(BC$Leps_AF~BC$Leps_mot); summary(llm)
nm=lm(Norway$AF~Norway$Tot_Mob); summary(nm)

nor=nls(AF~a*Tot_Mob,data=Norway,start=list(a=0.5))
bbc=nls(Leps_AF~a*Leps_mot,data=BC,start=list(a=0.5))

par(mfcol=c(2,2),mar=c(0.5,4,0.2,1),oma=c(5,0.2,1,0.2))
plot(hd$AF~hd$Tot_Mob,pch=20,xlim=c(0,6),ylim=c(0,3),xlab="",ylab="",main="",cex=0.1,las=1,axes=F); axis(2,0:3,0:3,las=1); box()
mtext(side=2,"Adult Female (AF) abundance",line=3); lines(seq(0,10,0.1),nor$m$getPars()*seq(0,10,0.1),col=8,lwd=2); 
text(x=1,y=2.8,"Norway",cex=1.5,font=2); text(x=1,y=2.5,expression(italic(R)^2 == 0.48),cex=1.1)
plot(BC$Leps_AF~BC$Leps_mot,pch=20,xlim=c(0,6),ylim=c(0,3),xlab="",ylab="",main="",cex=0.1,las=1,axes=F); axis(1); axis(2,0:3,0:3,las=1); box() #lines(x=seq(0,10,1),y=seq(0,10,1)*0.42,col=4)
mtext(side=2,"Adult Female (AF) abundance",line=3); mtext(side=1,"Total Mobile (TM) abundance",line=3); lines(seq(0,10,0.1),bbc$m$getPars()*seq(0,10,0.1),col=8,lwd=2); 
text(x=1,y=2.8,"BC",cex=1.5,font=2); text(x=1,y=2.5,expression(italic(R)^2 == 0.92),col=1,cex=1.1);

hist(hd$Prop_AF,las=1,xlab="",ylab="",main="",ylim=c(0,900),breaks=seq(-0.04,1.04,0.04),xlim=c(-0.1,1.04),axes=FALSE); mtext("Frequency",side=2,line=3.5); axis(2,las=1) #abline(v=median(Norway$Prop_AF,na.rm=T),col=3,lwd=3); abline(v=mean(Norway$Prop_AF,na.rm=T),col=4,lwd=3); 
text(x=.8,y=830,"Norway",cex=1.5,font=2); box(); text(x=.8,y=740,expression(paste(mu," = ")),cex=1.3)
text(x=0.95,y=750,labels=round(mean(hd$Prop_AF,na.rm=T),2),cex=1.3)
hist(BC$Prop_AF,las=1,xlab="Proportion",ylab="",main="",ylim=c(0,900),breaks=seq(-0.04,3,0.04),xlim=c(-0.1,1.04)); mtext("Frequency",side=2,line=3.5)#; abline(v=median(subset(BC$Prop_AF,BC$Prop_AF<=1),na.rm=T),col=3,lwd=3); abline(v=mean(subset(BC$Prop_AF,BC$Prop_AF<=1),na.rm=T),col=4,lwd=3)
text(x=.8,y=830,"BC",cex=1.5,font=2); mtext(side=1,"Proportion",line=3); box(); 
text(x=.8,y=740,expression(paste(mu," = ")),cex=1.3); text(x=0.95,y=750,labels=round(mean(BC$Prop_AF,na.rm=T),2),cex=1.3)
